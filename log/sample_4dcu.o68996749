device_str:  cuda:3
device_str:  cuda:0
device_str:  cuda:2
device_str:  cuda:1
Starting rank=3, seed=3, world_size=4.Starting rank=0, seed=0, world_size=4.Starting rank=2, seed=2, world_size=4.
Starting rank=1, seed=1, world_size=4.


Memory Allocated: 10.22 GB
Memory Allocated: 10.22 GB
Memory Reserved: 10.23 GB
Memory Reserved: 10.23 GB
Memory Allocated: 10.22 GB
Memory Reserved: 10.23 GB
Memory Allocated: 10.22 GB
Memory Reserved: 10.23 GB
f15r1n04:14252:14252 [0] NCCL INFO Bootstrap : Using ib0:11.6.15.5<0>
f15r1n04:14252:14252 [0] NCCL INFO NET/Plugin : No plugin found (librccl-net.so), using internal implementation
RCCL version 2.13.4+hip5.4 HEAD:fc5908f
f15r1n04:14252:16256 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [RO]; OOB ib0:11.6.15.5<0>
f15r1n04:14252:16256 [0] NCCL INFO Using network IB
f15r1n04:14254:14254 [2] NCCL INFO Bootstrap : Using ib0:11.6.15.5<0>
f15r1n04:14254:14254 [2] NCCL INFO NET/Plugin : No plugin found (librccl-net.so), using internal implementation
f15r1n04:14254:16259 [2] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [RO]; OOB ib0:11.6.15.5<0>
f15r1n04:14254:16259 [2] NCCL INFO Using network IB
f15r1n04:14253:14253 [1] NCCL INFO Bootstrap : Using ib0:11.6.15.5<0>
f15r1n04:14255:14255 [3] NCCL INFO Bootstrap : Using ib0:11.6.15.5<0>
f15r1n04:14253:14253 [1] NCCL INFO NET/Plugin : No plugin found (librccl-net.so), using internal implementation
f15r1n04:14255:14255 [3] NCCL INFO NET/Plugin : No plugin found (librccl-net.so), using internal implementation
f15r1n04:14253:16261 [1] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [RO]; OOB ib0:11.6.15.5<0>
f15r1n04:14255:16262 [3] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [RO]; OOB ib0:11.6.15.5<0>
f15r1n04:14253:16261 [1] NCCL INFO Using network IB
f15r1n04:14255:16262 [3] NCCL INFO Using network IB
f15r1n04:14252:16256 [0] NCCL INFO rocm_smi_lib: version 2.8.0.0
f15r1n04:14253:16261 [1] NCCL INFO rocm_smi_lib: version 2.8.0.0
f15r1n04:14254:16259 [2] NCCL INFO rocm_smi_lib: version 2.8.0.0
f15r1n04:14255:16262 [3] NCCL INFO rocm_smi_lib: version 2.8.0.0
f15r1n04:14252:16256 [0] NCCL INFO Setting affinity for GPU 0 to ff
f15r1n04:14253:16261 [1] NCCL INFO Setting affinity for GPU 1 to ff00
f15r1n04:14254:16259 [2] NCCL INFO Setting affinity for GPU 2 to ff0000
f15r1n04:14255:16262 [3] NCCL INFO Setting affinity for GPU 3 to ff000000
f15r1n04:14255:16262 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2 comm 0x2b3164000ab0 nRanks 04 busId 63000
f15r1n04:14254:16259 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1 comm 0x2aedd8000ab0 nRanks 04 busId 43000
f15r1n04:14252:16256 [0] NCCL INFO Channel 00/02 :    0   1   2   3
f15r1n04:14253:16261 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0 comm 0x2b5da0000ab0 nRanks 04 busId 26000
f15r1n04:14252:16256 [0] NCCL INFO Channel 01/02 :    0   1   2   3
f15r1n04:14252:16256 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 comm 0x2adad8000ab0 nRanks 04 busId 4000
f15r1n04:14255:16262 [3] NCCL INFO Channel 00 : 3[63000] -> 0[4000] via P2P/IPC comm 0x2b3164000ab0 nRanks 04
f15r1n04:14255:16262 [3] NCCL INFO Channel 01 : 3[63000] -> 0[4000] via P2P/IPC comm 0x2b3164000ab0 nRanks 04
f15r1n04:14252:16256 [0] NCCL INFO Channel 00 : 0[4000] -> 1[26000] via P2P/IPC comm 0x2adad8000ab0 nRanks 04
f15r1n04:14254:16259 [2] NCCL INFO Channel 00 : 2[43000] -> 3[63000] via P2P/IPC comm 0x2aedd8000ab0 nRanks 04
f15r1n04:14252:16256 [0] NCCL INFO Channel 01 : 0[4000] -> 1[26000] via P2P/IPC comm 0x2adad8000ab0 nRanks 04
f15r1n04:14254:16259 [2] NCCL INFO Channel 01 : 2[43000] -> 3[63000] via P2P/IPC comm 0x2aedd8000ab0 nRanks 04
f15r1n04:14253:16261 [1] NCCL INFO Channel 00 : 1[26000] -> 2[43000] via P2P/IPC comm 0x2b5da0000ab0 nRanks 04
f15r1n04:14253:16261 [1] NCCL INFO Channel 01 : 1[26000] -> 2[43000] via P2P/IPC comm 0x2b5da0000ab0 nRanks 04
f15r1n04:14255:16262 [3] NCCL INFO Connected all rings comm 0x2b3164000ab0 nRanks 04 busId 63000
f15r1n04:14255:16262 [3] NCCL INFO Channel 00 : 3[63000] -> 2[43000] via P2P/IPC comm 0x2b3164000ab0 nRanks 04
f15r1n04:14252:16256 [0] NCCL INFO Connected all rings comm 0x2adad8000ab0 nRanks 04 busId 4000
f15r1n04:14255:16262 [3] NCCL INFO Channel 01 : 3[63000] -> 2[43000] via P2P/IPC comm 0x2b3164000ab0 nRanks 04
f15r1n04:14253:16261 [1] NCCL INFO Connected all rings comm 0x2b5da0000ab0 nRanks 04 busId 26000
f15r1n04:14254:16259 [2] NCCL INFO Connected all rings comm 0x2aedd8000ab0 nRanks 04 busId 43000
f15r1n04:14253:16261 [1] NCCL INFO Channel 00 : 1[26000] -> 0[4000] via P2P/IPC comm 0x2b5da0000ab0 nRanks 04
f15r1n04:14254:16259 [2] NCCL INFO Channel 00 : 2[43000] -> 1[26000] via P2P/IPC comm 0x2aedd8000ab0 nRanks 04
f15r1n04:14253:16261 [1] NCCL INFO Channel 01 : 1[26000] -> 0[4000] via P2P/IPC comm 0x2b5da0000ab0 nRanks 04
f15r1n04:14254:16259 [2] NCCL INFO Channel 01 : 2[43000] -> 1[26000] via P2P/IPC comm 0x2aedd8000ab0 nRanks 04
f15r1n04:14255:16262 [3] NCCL INFO Connected all trees comm 0x2b3164000ab0 nRanks 04 busId 63000
f15r1n04:14252:16256 [0] NCCL INFO Connected all trees comm 0x2adad8000ab0 nRanks 04 busId 4000
f15r1n04:14255:16262 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/256
f15r1n04:14255:16262 [3] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
f15r1n04:14252:16256 [0] NCCL INFO Using tuning table 0 with LL128 disabled
f15r1n04:14252:16256 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/256
f15r1n04:14252:16256 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
f15r1n04:14253:16261 [1] NCCL INFO Connected all trees comm 0x2b5da0000ab0 nRanks 04 busId 26000
f15r1n04:14254:16259 [2] NCCL INFO Connected all trees comm 0x2aedd8000ab0 nRanks 04 busId 43000
f15r1n04:14253:16261 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/256
f15r1n04:14253:16261 [1] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
f15r1n04:14254:16259 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/256
f15r1n04:14254:16259 [2] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
f15r1n04:14252:16256 [0] NCCL INFO comm 0x2adad8000ab0 rank 0 nranks 4 cudaDev 0 busId 4000 localSize 136 used 33566400 bytes - Init COMPLETE
f15r1n04:14255:16262 [3] NCCL INFO comm 0x2b3164000ab0 rank 3 nranks 4 cudaDev 3 busId 63000 localSize 136 used 25177792 bytes - Init COMPLETE
f15r1n04:14253:16261 [1] NCCL INFO comm 0x2b5da0000ab0 rank 1 nranks 4 cudaDev 1 busId 26000 localSize 136 used 37760704 bytes - Init COMPLETE
f15r1n04:14254:16259 [2] NCCL INFO comm 0x2aedd8000ab0 rank 2 nranks 4 cudaDev 2 busId 43000 localSize 136 used 37760704 bytes - Init COMPLETE
Memory Allocated: 13.93 GB
Memory Reserved: 15.68 GB
Memory Allocated: 13.93 GB
Memory Reserved: 15.68 GB
Memory Allocated: 13.93 GB
Memory Reserved: 15.68 GB
Memory Allocated: 13.93 GB
Memory Reserved: 15.68 GB
torch.Size([3, 256, 256])
torch.Size([3, 256, 256])
torch.Size([3, 256, 256])
torch.Size([3, 256, 256])
image1.shape (256, 256)
image2.shape (256, 256)
torch.Size([3, 256, 256])
image1.shape (256, 256)
image2.shape (256, 256)
torch.Size([3, 256, 256])
image1.shape (256, 256)
image2.shape (256, 256)
torch.Size([3, 256, 256])
image1.shape (256, 256)
image2.shape (256, 256)
image1.shape (256, 256)
image2.shape (256, 256)
torch.Size([3, 256, 256])
image1.shape (256, 256)
image2.shape (256, 256)
torch.Size([3, 256, 256])
image1.shape (256, 256)
image2.shape (256, 256)
torch.Size([3, 256, 256])
image1.shape (256, 256)
image2.shape (256, 256)
image1.shape (256, 256)
image2.shape (256, 256)
torch.Size([3, 256, 256])
image1.shape (256, 256)
image2.shape (256, 256)
torch.Size([3, 256, 256])
image1.shape (256, 256)
image2.shape (256, 256)
torch.Size([3, 256, 256])
image1.shape (256, 256)
image2.shape (256, 256)
image1.shape (256, 256)
image2.shape (256, 256)
torch.Size([3, 256, 256])
image1.shape (256, 256)
image2.shape (256, 256)
torch.Size([3, 256, 256])
image1.shape (256, 256)
image2.shape (256, 256)
torch.Size([3, 256, 256])
image1.shape (256, 256)
image2.shape (256, 256)
