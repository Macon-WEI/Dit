mkdir failed on directory /var/lib/samba/lock/msg.lock: Permission denied
srun: ROUTE: split_hostlist: hl=f17r2n11 tree_width 0
[2024-05-05 20:12:49,748] torch.distributed.run: [WARNING] master_addr is only used for static rdzv_backend and when rdzv_endpoint is not specified.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0505 20:14:20.672631 11540 ProcessGroupNCCL.cpp:686] [Rank 1] ProcessGroupNCCL initialization options:NCCL_ASYNC_ERROR_HANDLING: 1, NCCL_DESYNC_DEBUG: 0, NCCL_ENABLE_TIMING: 0, NCCL_BLOCKING_WAIT: 0, TIMEOUT(ms): 1800000, USE_HIGH_PRIORITY_STREAM: 0, TORCH_DISTRIBUTED_DEBUG: OFF, NCCL_DEBUG: info, ID=204702928
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0505 20:14:20.672767 11541 ProcessGroupNCCL.cpp:686] [Rank 2] ProcessGroupNCCL initialization options:NCCL_ASYNC_ERROR_HANDLING: 1, NCCL_DESYNC_DEBUG: 0, NCCL_ENABLE_TIMING: 0, NCCL_BLOCKING_WAIT: 0, TIMEOUT(ms): 1800000, USE_HIGH_PRIORITY_STREAM: 0, TORCH_DISTRIBUTED_DEBUG: OFF, NCCL_DEBUG: info, ID=189018912
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0505 20:14:20.672771 11542 ProcessGroupNCCL.cpp:686] [Rank 3] ProcessGroupNCCL initialization options:NCCL_ASYNC_ERROR_HANDLING: 1, NCCL_DESYNC_DEBUG: 0, NCCL_ENABLE_TIMING: 0, NCCL_BLOCKING_WAIT: 0, TIMEOUT(ms): 1800000, USE_HIGH_PRIORITY_STREAM: 0, TORCH_DISTRIBUTED_DEBUG: OFF, NCCL_DEBUG: info, ID=211358800
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0505 20:14:20.672798 11539 ProcessGroupNCCL.cpp:686] [Rank 0] ProcessGroupNCCL initialization options:NCCL_ASYNC_ERROR_HANDLING: 1, NCCL_DESYNC_DEBUG: 0, NCCL_ENABLE_TIMING: 0, NCCL_BLOCKING_WAIT: 0, TIMEOUT(ms): 1800000, USE_HIGH_PRIORITY_STREAM: 0, TORCH_DISTRIBUTED_DEBUG: OFF, NCCL_DEBUG: info, ID=189331824
[[34m2024-05-05 20:14:21[0m] Experiment directory created at train-test1_4dcu/007-DiT-B-4
I0505 20:14:25.603327 11539 ProcessGroupNCCL.cpp:1340] NCCL_DEBUG: info
[[34m2024-05-05 20:14:30[0m] DiT Parameters: 130,475,648
[[34m2024-05-05 20:14:30[0m] Dataset contains 14,241 images (/public/home/acr0vd9ik6/project/DiT/fast-DiT/data1/dataset2.1)
[[34m2024-05-05 20:14:30[0m] Training for 1400 epochs...
[[34m2024-05-05 20:14:30[0m] Beginning epoch 0...
[[34m2024-05-05 20:17:00[0m] Beginning epoch 1...
[[34m2024-05-05 20:18:42[0m] (step=0000100) Train Loss: 0.3819, Train Steps/Sec: 0.40
[[34m2024-05-05 20:19:04[0m] Beginning epoch 2...
[[34m2024-05-05 20:21:07[0m] Beginning epoch 3...
[[34m2024-05-05 20:22:26[0m] (step=0000200) Train Loss: 0.1284, Train Steps/Sec: 0.45
[[34m2024-05-05 20:23:10[0m] Beginning epoch 4...
[[34m2024-05-05 20:25:13[0m] Beginning epoch 5...
[[34m2024-05-05 20:26:09[0m] (step=0000300) Train Loss: 0.1167, Train Steps/Sec: 0.45
[[34m2024-05-05 20:27:16[0m] Beginning epoch 6...
[[34m2024-05-05 20:29:19[0m] Beginning epoch 7...
[[34m2024-05-05 20:29:53[0m] (step=0000400) Train Loss: 0.1114, Train Steps/Sec: 0.45
[[34m2024-05-05 20:31:22[0m] Beginning epoch 8...
[[34m2024-05-05 20:33:25[0m] Beginning epoch 9...
[[34m2024-05-05 20:33:36[0m] (step=0000500) Train Loss: 0.1061, Train Steps/Sec: 0.45
[[34m2024-05-05 20:35:27[0m] Beginning epoch 10...
slurmstepd: error: *** JOB 60866253 ON f17r2n11 CANCELLED AT 2024-05-05T20:35:41 ***
slurmstepd: error: *** STEP 60866253.0 ON f17r2n11 CANCELLED AT 2024-05-05T20:35:41 ***
[2024-05-05 20:35:41,869] torch.distributed.elastic.agent.server.api: [WARNING] Received Signals.SIGTERM death signal, shutting down workers
