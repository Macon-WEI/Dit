mkdir failed on directory /var/lib/samba/lock/msg.lock: Permission denied
[2024-07-09 23:56:36,376] torch.distributed.run: [WARNING] master_addr is only used for static rdzv_backend and when rdzv_endpoint is not specified.
[2024-07-09 23:56:36,376] torch.distributed.run: [WARNING] 
[2024-07-09 23:56:36,376] torch.distributed.run: [WARNING] *****************************************
[2024-07-09 23:56:36,376] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-07-09 23:56:36,376] torch.distributed.run: [WARNING] *****************************************
Counting samples:   0%|          | 0/200 [00:00<?, ?it/s]Counting samples:   0%|          | 0/200 [00:00<?, ?it/s]Counting samples:   0%|          | 0/200 [00:00<?, ?it/s]Counting samples:   0%|          | 0/200 [00:00<?, ?it/s]Counting samples:   0%|          | 1/200 [00:00<01:12,  2.74it/s]Counting samples:   0%|          | 1/200 [00:00<01:12,  2.74it/s]Counting samples:   0%|          | 1/200 [00:00<01:12,  2.74it/s]Counting samples:   0%|          | 1/200 [00:00<01:12,  2.74it/s]Counting samples:   2%|▏         | 4/200 [00:00<00:20,  9.51it/s]Counting samples:   2%|▏         | 4/200 [00:00<00:20,  9.52it/s]Counting samples:   2%|▏         | 4/200 [00:00<00:20,  9.51it/s]Counting samples:   2%|▏         | 4/200 [00:00<00:20,  9.51it/s]Counting samples:   3%|▎         | 6/200 [00:00<00:16, 11.46it/s]Counting samples:   3%|▎         | 6/200 [00:00<00:16, 11.46it/s]Counting samples:   3%|▎         | 6/200 [00:00<00:16, 11.46it/s]Counting samples:   3%|▎         | 6/200 [00:00<00:16, 11.44it/s]Counting samples:   4%|▍         | 9/200 [00:00<00:12, 14.97it/s]Counting samples:   4%|▍         | 9/200 [00:00<00:12, 14.98it/s]Counting samples:   4%|▍         | 9/200 [00:00<00:12, 14.96it/s]Counting samples:   4%|▍         | 9/200 [00:00<00:12, 14.96it/s]Counting samples:   6%|▌         | 11/200 [00:00<00:11, 16.22it/s]Counting samples:   6%|▌         | 11/200 [00:00<00:11, 16.20it/s]Counting samples:   6%|▌         | 11/200 [00:00<00:11, 16.20it/s]Counting samples:   6%|▌         | 11/200 [00:00<00:11, 16.19it/s]Counting samples:   7%|▋         | 14/200 [00:00<00:10, 18.15it/s]Counting samples:   7%|▋         | 14/200 [00:00<00:10, 18.14it/s]Counting samples:   7%|▋         | 14/200 [00:00<00:10, 18.13it/s]Counting samples:   7%|▋         | 14/200 [00:00<00:10, 18.10it/s]Counting samples:   8%|▊         | 17/200 [00:01<00:09, 18.90it/s]Counting samples:   8%|▊         | 17/200 [00:01<00:09, 18.89it/s]Counting samples:   8%|▊         | 17/200 [00:01<00:09, 18.90it/s]Counting samples:   8%|▊         | 17/200 [00:01<00:09, 18.85it/s]Counting samples:  10%|█         | 20/200 [00:01<00:08, 20.53it/s]Counting samples:  10%|█         | 20/200 [00:01<00:08, 20.54it/s]Counting samples:  10%|█         | 20/200 [00:01<00:08, 20.54it/s]Counting samples:  10%|█         | 20/200 [00:01<00:08, 20.52it/s]Counting samples:  12%|█▏        | 23/200 [00:01<00:07, 22.28it/s]Counting samples:  12%|█▏        | 23/200 [00:01<00:07, 22.29it/s]Counting samples:  12%|█▏        | 23/200 [00:01<00:07, 22.27it/s]Counting samples:  12%|█▏        | 23/200 [00:01<00:07, 22.27it/s]Counting samples:  13%|█▎        | 26/200 [00:01<00:07, 21.76it/s]Counting samples:  13%|█▎        | 26/200 [00:01<00:07, 21.76it/s]Counting samples:  13%|█▎        | 26/200 [00:01<00:07, 21.76it/s]Counting samples:  13%|█▎        | 26/200 [00:01<00:07, 21.76it/s]Counting samples:  14%|█▍        | 29/200 [00:01<00:07, 22.44it/s]Counting samples:  14%|█▍        | 29/200 [00:01<00:07, 22.43it/s]Counting samples:  14%|█▍        | 29/200 [00:01<00:07, 22.42it/s]Counting samples:  14%|█▍        | 29/200 [00:01<00:07, 22.43it/s]Counting samples:  16%|█▌        | 32/200 [00:01<00:07, 22.28it/s]Counting samples:  16%|█▌        | 32/200 [00:01<00:07, 22.28it/s]Counting samples:  16%|█▌        | 32/200 [00:01<00:07, 22.27it/s]Counting samples:  16%|█▌        | 32/200 [00:01<00:07, 22.26it/s]Counting samples:  18%|█▊        | 35/200 [00:01<00:07, 22.33it/s]Counting samples:  18%|█▊        | 35/200 [00:01<00:07, 22.32it/s]Counting samples:  18%|█▊        | 35/200 [00:01<00:07, 22.32it/s]Counting samples:  18%|█▊        | 35/200 [00:01<00:07, 22.33it/s]Counting samples:  19%|█▉        | 38/200 [00:02<00:07, 21.68it/s]Counting samples:  19%|█▉        | 38/200 [00:02<00:07, 21.68it/s]Counting samples:  19%|█▉        | 38/200 [00:02<00:07, 21.68it/s]Counting samples:  19%|█▉        | 38/200 [00:02<00:07, 21.66it/s]Counting samples:  20%|██        | 41/200 [00:02<00:08, 18.62it/s]Counting samples:  20%|██        | 41/200 [00:02<00:08, 18.62it/s]Counting samples:  20%|██        | 41/200 [00:02<00:08, 18.62it/s]Counting samples:  20%|██        | 41/200 [00:02<00:08, 18.61it/s]Counting samples:  22%|██▏       | 44/200 [00:02<00:08, 19.04it/s]Counting samples:  22%|██▏       | 44/200 [00:02<00:08, 19.04it/s]Counting samples:  22%|██▏       | 44/200 [00:02<00:08, 19.04it/s]Counting samples:  22%|██▏       | 44/200 [00:02<00:08, 19.02it/s]Counting samples:  23%|██▎       | 46/200 [00:02<00:08, 19.18it/s]Counting samples:  23%|██▎       | 46/200 [00:02<00:08, 19.16it/s]Counting samples:  23%|██▎       | 46/200 [00:02<00:08, 19.16it/s]Counting samples:  23%|██▎       | 46/200 [00:02<00:08, 19.14it/s]Counting samples:  24%|██▍       | 48/200 [00:02<00:08, 17.75it/s]Counting samples:  24%|██▍       | 48/200 [00:02<00:08, 17.75it/s]Counting samples:  24%|██▍       | 48/200 [00:02<00:08, 17.76it/s]Counting samples:  24%|██▍       | 48/200 [00:02<00:08, 17.74it/s]Counting samples:  26%|██▌       | 51/200 [00:02<00:07, 18.74it/s]Counting samples:  26%|██▌       | 51/200 [00:02<00:07, 18.74it/s]Counting samples:  26%|██▌       | 51/200 [00:02<00:07, 18.74it/s]Counting samples:  26%|██▌       | 51/200 [00:02<00:07, 18.73it/s]Counting samples:  26%|██▋       | 53/200 [00:02<00:07, 18.79it/s]Counting samples:  26%|██▋       | 53/200 [00:02<00:07, 18.77it/s]Counting samples:  26%|██▋       | 53/200 [00:02<00:07, 18.78it/s]Counting samples:  26%|██▋       | 53/200 [00:02<00:07, 18.77it/s]Counting samples:  28%|██▊       | 56/200 [00:03<00:07, 19.44it/s]Counting samples:  28%|██▊       | 56/200 [00:03<00:07, 19.43it/s]Counting samples:  28%|██▊       | 56/200 [00:03<00:07, 19.43it/s]Counting samples:  28%|██▊       | 56/200 [00:03<00:07, 19.39it/s]Counting samples:  29%|██▉       | 58/200 [00:03<00:07, 19.49it/s]Counting samples:  29%|██▉       | 58/200 [00:03<00:07, 19.47it/s]Counting samples:  29%|██▉       | 58/200 [00:03<00:07, 19.48it/s]Counting samples:  29%|██▉       | 58/200 [00:03<00:07, 19.43it/s]Counting samples:  30%|███       | 61/200 [00:03<00:06, 20.87it/s]Counting samples:  30%|███       | 61/200 [00:03<00:06, 20.86it/s]Counting samples:  30%|███       | 61/200 [00:03<00:06, 20.87it/s]Counting samples:  30%|███       | 61/200 [00:03<00:06, 20.87it/s]Counting samples:  32%|███▏      | 64/200 [00:03<00:06, 20.83it/s]Counting samples:  32%|███▏      | 64/200 [00:03<00:06, 20.84it/s]Counting samples:  32%|███▏      | 64/200 [00:03<00:06, 20.83it/s]Counting samples:  32%|███▏      | 64/200 [00:03<00:06, 20.81it/s]Counting samples:  34%|███▎      | 67/200 [00:03<00:06, 19.92it/s]Counting samples:  34%|███▎      | 67/200 [00:03<00:06, 19.92it/s]Counting samples:  34%|███▎      | 67/200 [00:03<00:06, 19.93it/s]Counting samples:  34%|███▎      | 67/200 [00:03<00:06, 19.92it/s]Counting samples:  35%|███▌      | 70/200 [00:03<00:06, 19.65it/s]Counting samples:  35%|███▌      | 70/200 [00:03<00:06, 19.65it/s]Counting samples:  35%|███▌      | 70/200 [00:03<00:06, 19.65it/s]Counting samples:  35%|███▌      | 70/200 [00:03<00:06, 19.65it/s]Counting samples:  36%|███▋      | 73/200 [00:03<00:06, 20.80it/s]Counting samples:  36%|███▋      | 73/200 [00:03<00:06, 20.79it/s]Counting samples:  36%|███▋      | 73/200 [00:03<00:06, 20.78it/s]Counting samples:  36%|███▋      | 73/200 [00:03<00:06, 20.76it/s]Counting samples:  38%|███▊      | 76/200 [00:04<00:05, 21.72it/s]Counting samples:  38%|███▊      | 76/200 [00:04<00:05, 21.72it/s]Counting samples:  38%|███▊      | 76/200 [00:04<00:05, 21.72it/s]Counting samples:  38%|███▊      | 76/200 [00:04<00:05, 21.73it/s]Counting samples:  40%|███▉      | 79/200 [00:04<00:05, 21.64it/s]Counting samples:  40%|███▉      | 79/200 [00:04<00:05, 21.62it/s]Counting samples:  40%|███▉      | 79/200 [00:04<00:05, 21.64it/s]Counting samples:  40%|███▉      | 79/200 [00:04<00:05, 21.62it/s]Counting samples:  41%|████      | 82/200 [00:04<00:05, 20.64it/s]Counting samples:  41%|████      | 82/200 [00:04<00:05, 20.62it/s]Counting samples:  41%|████      | 82/200 [00:04<00:05, 20.63it/s]Counting samples:  41%|████      | 82/200 [00:04<00:05, 20.59it/s]Counting samples:  42%|████▎     | 85/200 [00:04<00:05, 20.82it/s]Counting samples:  42%|████▎     | 85/200 [00:04<00:05, 20.81it/s]Counting samples:  42%|████▎     | 85/200 [00:04<00:05, 20.79it/s]Counting samples:  42%|████▎     | 85/200 [00:04<00:05, 20.56it/s]Counting samples:  44%|████▍     | 88/200 [00:04<00:05, 20.23it/s]Counting samples:  44%|████▍     | 88/200 [00:04<00:05, 20.23it/s]Counting samples:  44%|████▍     | 88/200 [00:04<00:05, 20.30it/s]Counting samples:  44%|████▍     | 88/200 [00:04<00:05, 20.22it/s]Counting samples:  46%|████▌     | 91/200 [00:04<00:05, 19.98it/s]Counting samples:  46%|████▌     | 91/200 [00:04<00:05, 19.98it/s]Counting samples:  46%|████▌     | 91/200 [00:04<00:05, 19.97it/s]Counting samples:  46%|████▌     | 91/200 [00:04<00:05, 20.02it/s]Counting samples:  47%|████▋     | 94/200 [00:04<00:05, 18.75it/s]Counting samples:  47%|████▋     | 94/200 [00:04<00:05, 18.75it/s]Counting samples:  47%|████▋     | 94/200 [00:04<00:05, 18.74it/s]Counting samples:  47%|████▋     | 94/200 [00:04<00:05, 18.76it/s]Counting samples:  48%|████▊     | 97/200 [00:05<00:05, 19.12it/s]Counting samples:  48%|████▊     | 97/200 [00:05<00:05, 19.11it/s]Counting samples:  48%|████▊     | 97/200 [00:05<00:05, 19.14it/s]Counting samples:  48%|████▊     | 97/200 [00:05<00:05, 19.11it/s]Counting samples:  50%|█████     | 100/200 [00:05<00:04, 20.40it/s]Counting samples:  50%|█████     | 100/200 [00:05<00:04, 20.42it/s]Counting samples:  50%|█████     | 100/200 [00:05<00:04, 20.39it/s]Counting samples:  50%|█████     | 100/200 [00:05<00:04, 20.37it/s]Counting samples:  52%|█████▏    | 103/200 [00:05<00:04, 21.10it/s]Counting samples:  52%|█████▏    | 103/200 [00:05<00:04, 21.10it/s]Counting samples:  52%|█████▏    | 103/200 [00:05<00:04, 21.11it/s]Counting samples:  52%|█████▏    | 103/200 [00:05<00:04, 21.07it/s]Counting samples:  53%|█████▎    | 106/200 [00:05<00:04, 20.78it/s]Counting samples:  53%|█████▎    | 106/200 [00:05<00:04, 20.77it/s]Counting samples:  53%|█████▎    | 106/200 [00:05<00:04, 20.77it/s]Counting samples:  53%|█████▎    | 106/200 [00:05<00:04, 20.77it/s]Counting samples:  55%|█████▍    | 109/200 [00:05<00:04, 20.55it/s]Counting samples:  55%|█████▍    | 109/200 [00:05<00:04, 20.52it/s]Counting samples:  55%|█████▍    | 109/200 [00:05<00:04, 20.48it/s]Counting samples:  55%|█████▍    | 109/200 [00:05<00:04, 20.48it/s]Counting samples:  56%|█████▌    | 112/200 [00:05<00:04, 20.73it/s]Counting samples:  56%|█████▌    | 112/200 [00:05<00:04, 20.74it/s]Counting samples:  56%|█████▌    | 112/200 [00:05<00:04, 20.72it/s]Counting samples:  56%|█████▌    | 112/200 [00:05<00:04, 20.70it/s]Counting samples:  57%|█████▊    | 115/200 [00:06<00:05, 16.64it/s]Counting samples:  57%|█████▊    | 115/200 [00:06<00:05, 16.63it/s]Counting samples:  57%|█████▊    | 115/200 [00:06<00:05, 16.64it/s]Counting samples:  57%|█████▊    | 115/200 [00:06<00:05, 16.63it/s]Counting samples:  58%|█████▊    | 117/200 [00:06<00:05, 15.79it/s]Counting samples:  58%|█████▊    | 117/200 [00:06<00:05, 15.79it/s]Counting samples:  58%|█████▊    | 117/200 [00:06<00:05, 15.78it/s]Counting samples:  58%|█████▊    | 117/200 [00:06<00:05, 15.77it/s]Counting samples:  60%|██████    | 120/200 [00:06<00:04, 17.14it/s]Counting samples:  60%|██████    | 120/200 [00:06<00:04, 17.14it/s]Counting samples:  60%|██████    | 120/200 [00:06<00:04, 17.13it/s]Counting samples:  60%|██████    | 120/200 [00:06<00:04, 17.14it/s]Counting samples:  61%|██████    | 122/200 [00:06<00:04, 17.41it/s]Counting samples:  61%|██████    | 122/200 [00:06<00:04, 17.41it/s]Counting samples:  61%|██████    | 122/200 [00:06<00:04, 17.41it/s]Counting samples:  61%|██████    | 122/200 [00:06<00:04, 17.41it/s]Counting samples:  62%|██████▏   | 124/200 [00:06<00:04, 16.85it/s]Counting samples:  62%|██████▏   | 124/200 [00:06<00:04, 16.84it/s]Counting samples:  62%|██████▏   | 124/200 [00:06<00:04, 16.84it/s]Counting samples:  62%|██████▏   | 124/200 [00:06<00:04, 16.84it/s]Counting samples:  63%|██████▎   | 126/200 [00:06<00:04, 17.36it/s]Counting samples:  63%|██████▎   | 126/200 [00:06<00:04, 17.35it/s]Counting samples:  63%|██████▎   | 126/200 [00:06<00:04, 17.36it/s]Counting samples:  63%|██████▎   | 126/200 [00:06<00:04, 17.33it/s]Counting samples:  64%|██████▍   | 129/200 [00:06<00:03, 18.85it/s]Counting samples:  64%|██████▍   | 129/200 [00:06<00:03, 18.84it/s]Counting samples:  64%|██████▍   | 129/200 [00:06<00:03, 18.84it/s]Counting samples:  64%|██████▍   | 129/200 [00:06<00:03, 18.83it/s]Counting samples:  66%|██████▌   | 132/200 [00:06<00:03, 19.62it/s]Counting samples:  66%|██████▌   | 132/200 [00:06<00:03, 19.62it/s]Counting samples:  66%|██████▌   | 132/200 [00:06<00:03, 19.62it/s]Counting samples:  66%|██████▌   | 132/200 [00:06<00:03, 19.61it/s]Counting samples:  67%|██████▋   | 134/200 [00:07<00:03, 18.09it/s]Counting samples:  67%|██████▋   | 134/200 [00:07<00:03, 18.09it/s]Counting samples:  67%|██████▋   | 134/200 [00:07<00:03, 18.09it/s]Counting samples:  67%|██████▋   | 134/200 [00:07<00:03, 18.08it/s]Counting samples:  68%|██████▊   | 137/200 [00:07<00:03, 19.05it/s]Counting samples:  68%|██████▊   | 137/200 [00:07<00:03, 19.05it/s]Counting samples:  68%|██████▊   | 137/200 [00:07<00:03, 19.03it/s]Counting samples:  68%|██████▊   | 137/200 [00:07<00:03, 19.02it/s]Counting samples:  70%|██████▉   | 139/200 [00:07<00:03, 17.88it/s]Counting samples:  70%|██████▉   | 139/200 [00:07<00:03, 17.86it/s]Counting samples:  70%|██████▉   | 139/200 [00:07<00:03, 17.85it/s]Counting samples:  70%|██████▉   | 139/200 [00:07<00:03, 17.85it/s]Counting samples:  71%|███████   | 142/200 [00:07<00:03, 18.87it/s]Counting samples:  71%|███████   | 142/200 [00:07<00:03, 18.87it/s]Counting samples:  71%|███████   | 142/200 [00:07<00:03, 18.86it/s]Counting samples:  71%|███████   | 142/200 [00:07<00:03, 18.86it/s]Counting samples:  72%|███████▎  | 145/200 [00:07<00:02, 19.47it/s]Counting samples:  72%|███████▎  | 145/200 [00:07<00:02, 19.46it/s]Counting samples:  72%|███████▎  | 145/200 [00:07<00:02, 19.45it/s]Counting samples:  72%|███████▎  | 145/200 [00:07<00:02, 19.46it/s]Counting samples:  74%|███████▎  | 147/200 [00:07<00:02, 18.93it/s]Counting samples:  74%|███████▎  | 147/200 [00:07<00:02, 18.92it/s]Counting samples:  74%|███████▎  | 147/200 [00:07<00:02, 18.92it/s]Counting samples:  74%|███████▎  | 147/200 [00:07<00:02, 18.90it/s]Counting samples:  75%|███████▌  | 150/200 [00:07<00:02, 19.78it/s]Counting samples:  75%|███████▌  | 150/200 [00:07<00:02, 19.77it/s]Counting samples:  75%|███████▌  | 150/200 [00:07<00:02, 19.77it/s]Counting samples:  75%|███████▌  | 150/200 [00:07<00:02, 19.78it/s]Counting samples:  76%|███████▌  | 152/200 [00:08<00:02, 19.55it/s]Counting samples:  76%|███████▌  | 152/200 [00:08<00:02, 19.54it/s]Counting samples:  76%|███████▌  | 152/200 [00:08<00:02, 19.54it/s]Counting samples:  76%|███████▌  | 152/200 [00:08<00:02, 19.54it/s]Counting samples:  78%|███████▊  | 155/200 [00:08<00:02, 19.69it/s]Counting samples:  78%|███████▊  | 155/200 [00:08<00:02, 19.67it/s]Counting samples:  78%|███████▊  | 155/200 [00:08<00:02, 19.67it/s]Counting samples:  78%|███████▊  | 155/200 [00:08<00:02, 19.66it/s]Counting samples:  79%|███████▉  | 158/200 [00:08<00:02, 20.01it/s]Counting samples:  79%|███████▉  | 158/200 [00:08<00:02, 20.01it/s]Counting samples:  79%|███████▉  | 158/200 [00:08<00:02, 20.01it/s]Counting samples:  79%|███████▉  | 158/200 [00:08<00:02, 20.00it/s]Counting samples:  80%|████████  | 161/200 [00:08<00:01, 21.02it/s]Counting samples:  80%|████████  | 161/200 [00:08<00:01, 21.01it/s]Counting samples:  80%|████████  | 161/200 [00:08<00:01, 21.03it/s]Counting samples:  80%|████████  | 161/200 [00:08<00:01, 21.02it/s]Counting samples:  82%|████████▏ | 164/200 [00:08<00:01, 19.03it/s]Counting samples:  82%|████████▏ | 164/200 [00:08<00:01, 19.01it/s]Counting samples:  82%|████████▏ | 164/200 [00:08<00:01, 19.01it/s]Counting samples:  82%|████████▏ | 164/200 [00:08<00:01, 19.01it/s]Counting samples:  84%|████████▎ | 167/200 [00:08<00:01, 19.11it/s]Counting samples:  84%|████████▎ | 167/200 [00:08<00:01, 19.12it/s]Counting samples:  84%|████████▎ | 167/200 [00:08<00:01, 19.11it/s]Counting samples:  84%|████████▎ | 167/200 [00:08<00:01, 19.11it/s]Counting samples:  84%|████████▍ | 169/200 [00:08<00:01, 18.80it/s]Counting samples:  84%|████████▍ | 169/200 [00:08<00:01, 18.79it/s]Counting samples:  84%|████████▍ | 169/200 [00:08<00:01, 18.79it/s]Counting samples:  84%|████████▍ | 169/200 [00:08<00:01, 18.76it/s]Counting samples:  86%|████████▌ | 171/200 [00:09<00:01, 19.01it/s]Counting samples:  86%|████████▌ | 171/200 [00:09<00:01, 19.01it/s]Counting samples:  86%|████████▌ | 171/200 [00:09<00:01, 19.01it/s]Counting samples:  86%|████████▌ | 171/200 [00:09<00:01, 18.98it/s]Counting samples:  86%|████████▋ | 173/200 [00:09<00:01, 18.46it/s]Counting samples:  86%|████████▋ | 173/200 [00:09<00:01, 18.45it/s]Counting samples:  86%|████████▋ | 173/200 [00:09<00:01, 18.44it/s]Counting samples:  86%|████████▋ | 173/200 [00:09<00:01, 18.40it/s]Counting samples:  88%|████████▊ | 176/200 [00:09<00:01, 18.42it/s]Counting samples:  88%|████████▊ | 176/200 [00:09<00:01, 18.40it/s]Counting samples:  88%|████████▊ | 176/200 [00:09<00:01, 18.39it/s]Counting samples:  88%|████████▊ | 176/200 [00:09<00:01, 18.38it/s]Counting samples:  90%|████████▉ | 179/200 [00:09<00:01, 19.78it/s]Counting samples:  90%|████████▉ | 179/200 [00:09<00:01, 19.77it/s]Counting samples:  90%|████████▉ | 179/200 [00:09<00:01, 19.75it/s]Counting samples:  90%|████████▉ | 179/200 [00:09<00:01, 18.62it/s]Counting samples:  91%|█████████ | 182/200 [00:09<00:00, 20.51it/s]Counting samples:  91%|█████████ | 182/200 [00:09<00:00, 20.49it/s]Counting samples:  91%|█████████ | 182/200 [00:09<00:00, 20.49it/s]Counting samples:  91%|█████████ | 182/200 [00:09<00:00, 20.88it/s]Counting samples:  92%|█████████▎| 185/200 [00:09<00:00, 20.30it/s]Counting samples:  92%|█████████▎| 185/200 [00:09<00:00, 20.30it/s]Counting samples:  92%|█████████▎| 185/200 [00:09<00:00, 20.56it/s]Counting samples:  92%|█████████▎| 185/200 [00:09<00:00, 20.29it/s]Counting samples:  94%|█████████▍| 188/200 [00:09<00:00, 19.84it/s]Counting samples:  94%|█████████▍| 188/200 [00:09<00:00, 19.84it/s]Counting samples:  94%|█████████▍| 188/200 [00:09<00:00, 19.96it/s]Counting samples:  94%|█████████▍| 188/200 [00:09<00:00, 19.77it/s]Counting samples:  95%|█████████▌| 190/200 [00:09<00:00, 19.75it/s]Counting samples:  95%|█████████▌| 190/200 [00:09<00:00, 19.72it/s]Counting samples:  95%|█████████▌| 190/200 [00:09<00:00, 19.71it/s]Counting samples:  96%|█████████▌| 191/200 [00:10<00:00, 19.95it/s]Counting samples:  96%|█████████▌| 192/200 [00:10<00:00, 19.72it/s]Counting samples:  96%|█████████▌| 192/200 [00:10<00:00, 19.70it/s]Counting samples:  96%|█████████▌| 192/200 [00:10<00:00, 19.69it/s]Counting samples:  97%|█████████▋| 194/200 [00:10<00:00, 19.29it/s]Counting samples:  97%|█████████▋| 194/200 [00:10<00:00, 19.08it/s]Counting samples:  97%|█████████▋| 194/200 [00:10<00:00, 19.07it/s]Counting samples:  97%|█████████▋| 194/200 [00:10<00:00, 19.08it/s]Counting samples:  98%|█████████▊| 196/200 [00:10<00:00, 19.19it/s]Counting samples:  98%|█████████▊| 196/200 [00:10<00:00, 19.18it/s]Counting samples:  98%|█████████▊| 196/200 [00:10<00:00, 19.31it/s]Counting samples:  98%|█████████▊| 196/200 [00:10<00:00, 19.19it/s]Counting samples: 100%|█████████▉| 199/200 [00:10<00:00, 20.13it/s]Counting samples: 100%|█████████▉| 199/200 [00:10<00:00, 20.12it/s]Counting samples: 100%|█████████▉| 199/200 [00:10<00:00, 20.10it/s]Counting samples: 100%|█████████▉| 199/200 [00:10<00:00, 20.10it/s]Counting samples: 100%|██████████| 200/200 [00:10<00:00, 19.10it/s]
Counting samples: 100%|██████████| 200/200 [00:10<00:00, 19.10it/s]Counting samples: 100%|██████████| 200/200 [00:10<00:00, 19.10it/s]

Counting samples: 100%|██████████| 200/200 [00:10<00:00, 19.10it/s]
Traceback (most recent call last):
Traceback (most recent call last):
  File "/public/home/acr0vd9ik6/miniconda3/envs/torch-2.1.0.dtk-24.04.cp310/lib/python3.10/site-packages/numpy/core/memmap.py", line 256, in __new__
  File "/public/home/acr0vd9ik6/miniconda3/envs/torch-2.1.0.dtk-24.04.cp310/lib/python3.10/site-packages/numpy/core/memmap.py", line 256, in __new__
Traceback (most recent call last):
  File "/public/home/acr0vd9ik6/miniconda3/envs/torch-2.1.0.dtk-24.04.cp310/lib/python3.10/site-packages/numpy/core/memmap.py", line 256, in __new__
Traceback (most recent call last):
  File "/public/home/acr0vd9ik6/miniconda3/envs/torch-2.1.0.dtk-24.04.cp310/lib/python3.10/site-packages/numpy/core/memmap.py", line 256, in __new__
    fid.flush()
OSError: [Errno 28] No space left on device    
fid.flush()
During handling of the above exception, another exception occurred:


Traceback (most recent call last):
  File "/public/home/acr0vd9ik6/project/DiT/fast-DiT/save_train_set_2_npz.py", line 110, in <module>
OSError    : fid.flush()[Errno 28] No space left on device
    
OSErrorfid.flush()    
During handling of the above exception, another exception occurred:


: npz_file = create_npz_from_train_folder_2('/public/home/acr0vd9ik6/project/DiT/train')Traceback (most recent call last):
OSError[Errno 28] No space left on device
  File "/public/home/acr0vd9ik6/project/DiT/fast-DiT/save_train_set_2_npz.py", line 110, in <module>

:   File "/public/home/acr0vd9ik6/project/DiT/fast-DiT/save_train_set_2_npz.py", line 84, in create_npz_from_train_folder_2

During handling of the above exception, another exception occurred:

[Errno 28] No space left on deviceTraceback (most recent call last):

  File "/public/home/acr0vd9ik6/project/DiT/fast-DiT/save_train_set_2_npz.py", line 110, in <module>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/public/home/acr0vd9ik6/project/DiT/fast-DiT/save_train_set_2_npz.py", line 110, in <module>
        npz_file = create_npz_from_train_folder_2('/public/home/acr0vd9ik6/project/DiT/train')samples = np.memmap(npz_path, dtype='uint8', mode='w+', shape=(total_samples, *sample_shape))

  File "/public/home/acr0vd9ik6/project/DiT/fast-DiT/save_train_set_2_npz.py", line 84, in create_npz_from_train_folder_2
  File "/public/home/acr0vd9ik6/miniconda3/envs/torch-2.1.0.dtk-24.04.cp310/lib/python3.10/site-packages/numpy/core/memmap.py", line 231, in __new__
        npz_file = create_npz_from_train_folder_2('/public/home/acr0vd9ik6/project/DiT/train')npz_file = create_npz_from_train_folder_2('/public/home/acr0vd9ik6/project/DiT/train')

  File "/public/home/acr0vd9ik6/project/DiT/fast-DiT/save_train_set_2_npz.py", line 84, in create_npz_from_train_folder_2
  File "/public/home/acr0vd9ik6/project/DiT/fast-DiT/save_train_set_2_npz.py", line 84, in create_npz_from_train_folder_2
    samples = np.memmap(npz_path, dtype='uint8', mode='w+', shape=(total_samples, *sample_shape))    
with f_ctx as fid:  File "/public/home/acr0vd9ik6/miniconda3/envs/torch-2.1.0.dtk-24.04.cp310/lib/python3.10/site-packages/numpy/core/memmap.py", line 231, in __new__

OSError        : samples = np.memmap(npz_path, dtype='uint8', mode='w+', shape=(total_samples, *sample_shape))samples = np.memmap(npz_path, dtype='uint8', mode='w+', shape=(total_samples, *sample_shape))[Errno 28] No space left on device


  File "/public/home/acr0vd9ik6/miniconda3/envs/torch-2.1.0.dtk-24.04.cp310/lib/python3.10/site-packages/numpy/core/memmap.py", line 231, in __new__
      File "/public/home/acr0vd9ik6/miniconda3/envs/torch-2.1.0.dtk-24.04.cp310/lib/python3.10/site-packages/numpy/core/memmap.py", line 231, in __new__
with f_ctx as fid:
OSError: [Errno 28] No space left on device
    with f_ctx as fid:    
with f_ctx as fid:OSError
: OSError[Errno 28] No space left on device: 
[Errno 28] No space left on device
[2024-07-09 23:56:51,619] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 0 (pid: 2118) of binary: /public/home/acr0vd9ik6/miniconda3/envs/torch-2.1.0.dtk-24.04.cp310/bin/python
Traceback (most recent call last):
  File "/public/home/acr0vd9ik6/miniconda3/envs/torch-2.1.0.dtk-24.04.cp310/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/public/home/acr0vd9ik6/miniconda3/envs/torch-2.1.0.dtk-24.04.cp310/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/public/home/acr0vd9ik6/miniconda3/envs/torch-2.1.0.dtk-24.04.cp310/lib/python3.10/site-packages/torch/distributed/run.py", line 806, in main
    run(args)
  File "/public/home/acr0vd9ik6/miniconda3/envs/torch-2.1.0.dtk-24.04.cp310/lib/python3.10/site-packages/torch/distributed/run.py", line 797, in run
    elastic_launch(
  File "/public/home/acr0vd9ik6/miniconda3/envs/torch-2.1.0.dtk-24.04.cp310/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/public/home/acr0vd9ik6/miniconda3/envs/torch-2.1.0.dtk-24.04.cp310/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 264, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
save_train_set_2_npz.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-09_23:56:51
  host      : b01r3n11
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2119)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-09_23:56:51
  host      : b01r3n11
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 2120)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-09_23:56:51
  host      : b01r3n11
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 2121)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-09_23:56:51
  host      : b01r3n11
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2118)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
